---
phase: 01-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/layout.tsx
  - src/app/globals.css
  - src/components/providers/theme-provider.tsx
  - tailwind.config.ts
  - components.json
autonomous: true

must_haves:
  truths:
    - "Site renders in dark mode by default without flash"
    - "Gold accent color (#C9A962) is applied to primary elements"
    - "Playfair Display serif font renders for headings"
    - "Body text uses readable sans-serif font"
    - "CSS variables enable consistent theming across components"
  artifacts:
    - path: "src/app/globals.css"
      provides: "CSS variables for dark theme colors"
      contains: "--primary: 43"
    - path: "src/components/providers/theme-provider.tsx"
      provides: "next-themes provider with dark default"
      contains: "defaultTheme"
    - path: "src/app/layout.tsx"
      provides: "Root layout with fonts and theme provider"
      contains: "Playfair_Display"
    - path: "tailwind.config.ts"
      provides: "Extended Tailwind config with custom fonts"
      contains: "fontFamily"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/providers/theme-provider.tsx"
      via: "ThemeProvider wrapping children"
      pattern: "<ThemeProvider>"
    - from: "tailwind.config.ts"
      to: "src/app/globals.css"
      via: "CSS variables referenced in config"
      pattern: "var\\(--"
---

<objective>
Establish the dark-mode-first design system with premium editorial aesthetic: gold accent colors, Playfair Display serif for headings, clean sans-serif for body text, and CSS variables for consistent theming.

Purpose: All UI components depend on this design foundation. The visual aesthetic (like The Atlantic/NYT) must be established before building pages.

Output: Working dark theme with no flash on load, custom fonts rendering, and shadcn/ui configured with project colors.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md

Reference CONTEXT.md for:
- Visual aesthetic decisions (premium editorial, soft dark palette)
- Gold/amber accent color requirement

Reference RESEARCH.md for:
- Pattern 3: Dark Mode with next-themes
- CSS Variables for Dark Theme example
- Font Setup with next/font example
- Common pitfall: next-themes Hydration Mismatch
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install design system dependencies and initialize shadcn/ui</name>
  <files>
    package.json
    components.json
    tailwind.config.ts
  </files>
  <action>
Install next-themes and lucide-react:
```bash
npm install next-themes lucide-react
```

Initialize shadcn/ui:
```bash
npx shadcn@latest init
```

When prompted:
- Style: Default
- Base color: Neutral (we'll customize)
- CSS variables: Yes
- Tailwind config: tailwind.config.ts
- Components location: src/components
- Utility location: src/lib/utils
- React Server Components: Yes
- Write CSS file: src/app/globals.css

After initialization, update `tailwind.config.ts` to add custom font families:

```typescript
fontFamily: {
  playfair: ['var(--font-playfair)', 'Georgia', 'serif'],
  sans: ['var(--font-sans)', 'system-ui', 'sans-serif'],
  serif: ['var(--font-playfair)', 'Georgia', 'serif'],
},
```
  </action>
  <verify>
    - `components.json` exists with shadcn configuration
    - `tailwind.config.ts` includes fontFamily extensions
    - `npm run build` succeeds
  </verify>
  <done>shadcn/ui initialized with custom font configuration</done>
</task>

<task type="auto">
  <name>Task 2: Configure dark theme CSS variables with gold accent</name>
  <files>
    src/app/globals.css
  </files>
  <action>
Update `src/app/globals.css` with custom dark theme colors.

**Color palette (HSL values):**

Light mode (fallback, rarely used):
- --background: 0 0% 100%
- --foreground: 0 0% 3.9%
- --primary: 43 74% 59% (Gold #C9A962)
- --primary-foreground: 0 0% 9%

Dark mode (default, primary):
- --background: 0 0% 6.7% (#111111 soft dark)
- --foreground: 0 0% 95%
- --primary: 43 74% 59% (Gold #C9A962)
- --primary-foreground: 0 0% 9%
- --card: 0 0% 8% (#141414)
- --card-foreground: 0 0% 95%
- --popover: 0 0% 8%
- --popover-foreground: 0 0% 95%
- --secondary: 0 0% 14.9%
- --secondary-foreground: 0 0% 95%
- --muted: 0 0% 14.9%
- --muted-foreground: 0 0% 63.9%
- --accent: 43 74% 59% (Gold, same as primary)
- --accent-foreground: 0 0% 9%
- --destructive: 0 62.8% 30.6%
- --destructive-foreground: 0 0% 95%
- --border: 0 0% 18%
- --input: 0 0% 18%
- --ring: 43 74% 59% (Gold for focus states)

Keep the Tailwind directives (@tailwind base/components/utilities) at the top.
Keep the @layer base block that shadcn added, just update the color values.

Add any additional utility classes needed for the editorial style after the shadcn layers.
  </action>
  <verify>
    - globals.css contains both :root and .dark color schemes
    - --primary uses HSL 43 74% 59% (gold)
    - --background in .dark is 0 0% 6.7% (soft dark)
    - File still has @tailwind directives
  </verify>
  <done>Dark theme CSS variables configured with gold accent and soft dark background</done>
</task>

<task type="auto">
  <name>Task 3: Create theme provider and configure root layout with fonts</name>
  <files>
    src/components/providers/theme-provider.tsx
    src/app/layout.tsx
  </files>
  <action>
Create theme provider (`src/components/providers/theme-provider.tsx`):

```typescript
"use client"

import * as React from "react"
import { ThemeProvider as NextThemesProvider } from "next-themes"

export function ThemeProvider({ children }: { children: React.ReactNode }) {
  return (
    <NextThemesProvider
      attribute="class"
      defaultTheme="dark"
      enableSystem={false}
      disableTransitionOnChange
    >
      {children}
    </NextThemesProvider>
  )
}
```

Key settings:
- `defaultTheme="dark"` - dark mode first
- `enableSystem={false}` - always dark, ignore system preference
- `disableTransitionOnChange` - prevents flash on theme load

Update root layout (`src/app/layout.tsx`):

1. Import fonts from next/font/google:
   - Playfair_Display (variable: --font-playfair, subsets: latin, display: swap)
   - Source_Sans_3 (variable: --font-sans, subsets: latin, display: swap)

2. Add `suppressHydrationWarning` to html tag (required for next-themes)

3. Add font variables to html className: `${playfair.variable} ${sourceSans.variable}`

4. Wrap children with ThemeProvider

5. Body should have: `className="font-sans antialiased bg-background text-foreground min-h-screen"`

6. Update metadata:
   - title: "The Daily Deep"
   - description: "Premium AI-powered investigative reports published daily"
  </action>
  <verify>
    - `npm run dev` shows dark background on localhost:3000
    - No hydration warnings in console
    - Inspect html tag shows "dark" class
    - Font variables visible in computed styles
  </verify>
  <done>Theme provider configured with dark default, fonts loading without flash</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Dark mode works:** `npm run dev` shows dark background (#111) immediately on page load
2. **No flash:** Page loads dark without momentary white flash
3. **Fonts load:**
   - Headings show Playfair Display serif
   - Body shows Source Sans 3
4. **Gold accent:** Primary color is gold when tested (can add a temporary button with `bg-primary` class)
5. **Build succeeds:** `npm run build` completes without errors
6. **CSS variables work:** Browser dev tools show custom properties in :root and .dark

Manual test: Add temporary content to src/app/page.tsx:
```tsx
<main className="p-8">
  <h1 className="font-playfair text-4xl text-primary">The Daily Deep</h1>
  <p className="text-muted-foreground mt-4">Testing typography</p>
</main>
```
Should render gold heading in Playfair Display on dark background.
</verification>

<success_criteria>
- Site loads in dark mode by default without any flash or flicker
- Gold accent color (#C9A962) displays correctly on primary elements
- Playfair Display serif font renders for elements with font-playfair or font-serif
- Source Sans 3 renders as default body font
- All CSS variables are properly configured for both light and dark modes
- shadcn/ui is initialized and ready for component usage
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
